# 函数式编程入土

## 函数式 VS 面向对象

函数式编程和面向对象编程有什么区别?

- 函数式编程是一种编程范式,面向对象是一种编程思想.
- 函数式通常是无状态的,面向对象通常是有状态的.
- 函数式更加注重数据的流转,面向对象更加注重数据的封装.
- 函数式更像是一种数学上的抽象,面向对象更像是一种现实上的抽象.

## 函数是一等公民

- 公民还分三六九等?
  - 不是,这里的一等公民是指函数可以像变量一样被传递,赋值,作为参数,作为返回值.
  - 所以说一等公民就是普通公民,即普通对象.
- 为什么钟爱一等公民
  - 一个函数只做一件事,这样的函数更容易被复用.
  - 没有 this,所以函数的行为更加确定,不会被上下文影响.
  - 没有副作用,不会对外部造成影响.

## 纯函数

- 纯函数是什么?
  - 相同的输入永远会得到相同的输出,且没有任何可观察的副作用.
  - 纯函数是指没有副作用的函数.
  - 副作用是指对外部环境产生了影响.
  - 副作用包括但不限于:修改了全局变量,修改了参数,修改了函数外部的变量,修改了 DOM,发送了 AJAX 请求,修改了文件等等.
- 为什么要追求纯函数?
  - 纯函数更容易被测试.
  - 纯函数更容易被复用.
  - 纯函数更容易推理,不会被外部环境影响.
- 总结特点
  - 可缓存性,相同的输入永远会得到相同的输出,可以使用缓存.
  - 可移植性/自文档化,纯函数可以自文档化,因为纯函数的输入/输出是一目了然的.
  - 可测试性,纯函数更容易测试.
  - 引用透明性,纯函数不依赖外部环境,不会被外部环境影响.
  - 并行代码,纯函数可以并行运行,因为纯函数不依赖外部环境.

## 柯里化

- 柯里化是什么?
  - 柯里化是指将一个多参数的函数转换成多个单参数的函数.
  - 柯里化是一种“预加载”函数的方法,通过传递较少的参数,得到一个已经记住了这些参数的新函数,某种意义上讲,这是一种对参数的“缓存”,是一种非常高效的编写函数的方法.
  - 柯里化允许传递多个参数,但是只是为了减少`()`(函数调用)的使用.

## 函数组合

- 函数组合是什么?
  - 函数组合是指将多个函数组合成一个函数.
  - 函数组合是一种“嵌套”多个函数的方法,每个函数接收一个参数,并且返回一个值,这个值会作为参数传递给下一个函数,最终返回结果.
  - 函数组合是一种高效的编写函数的方法.
  - 函数组合是一种高效的编写管道的方法.

```js
// 简单版
const compose = (f, g) => (x) => f(g(x));

// 复杂版
const compose =
  (...fns) =>
  (x) =>
    fns.reduceRight((v, f) => f(v), x);
```

### pointfree 模式

- pointfree 是什么?
  - pointfree 是指函数无须提及将要操作的数据是什么样的.
  - pointfree 就是使用一些通用的函数,组合出各种复杂运算.
  - pointfree 的本质就是使用一些函数,将业务逻辑中不会改变的部分抽离出来,从而让业务逻辑变得清晰.

```js
// 非 pointfree,因为提到了数据:word
const snakeCase = (word) => word.toLowerCase().replace(/\s+/gi, "_");
snakeCase("Hello World"); // => hello_world

// pointfree
const snakeCase = compose(replace(/\s+/gi, "_"), toLowerCase);
snakeCase("Hello World"); // => hello_world
```

### 管道 VS 组合

- 管道和组合有什么区别?
  - 管道是从左到右运行函数,组合是从右到左运行函数.
  - 管道是把数据从一个函数传递到另一个函数,组合是把函数从一个函数传递到另一个函数.
  - 管道是把函数作为数据处理,组合是把数据作为函数处理.
  - 管道是数据优先,组合是函数优先.
  - 管道是数据驱动,组合是函数驱动.
  - 管道是数据流动,组合是函数嵌套.

### 组合如何 debug

https://github.com/llh911001/mostly-adequate-guide-chinese/blob/master/ch5.md
